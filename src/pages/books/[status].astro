---
import { getCollection } from "astro:content";

import BlogLayout from "../../layouts/BlogLayout.astro";
// import Pagination from "../../components/Pagination.astro";
import BookList from "../../components/Booklist.astro"

export async function getStaticPaths() {
	const statusList = [
		'reading',
		'read',
		'unfinished',
	]

	return statusList.map(status => {
		return {
			params: { status },
		};
	});
}

const {status} = Astro.params;

const collection = await getCollection("books")
const shuffledCollection = collection
  .map(value => ({ value, sort: Math.random() }))
  .sort((a, b) => a.sort - b.sort)
  .map(({ value }) => value)
  .filter(book => status === book.data.status);
  
const pageTitle = "books";

const getStatString = status => {
	switch (status) {
		case 'reading':
			return "i'm reading";
		case 'read':
			return "i've read";
		case 'unfinished':
			return "i've left unfinished";
	}
}
---

<BlogLayout pageTitle={pageTitle}>
	<BookList 
		collection={shuffledCollection}
		title=`here are some books ${getStatString(status)}`
	  />
</BlogLayout>
